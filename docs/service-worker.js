import{precacheAndRoute}from"workbox-precaching";import{registerRoute,setCatchHandler}from"workbox-routing";import{NetworkFirst,CacheFirst}from"workbox-strategies";import{skipWaiting,clientsClaim}from"workbox-core";skipWaiting(),clientsClaim(),precacheAndRoute(self.__WB_MANIFEST),registerRoute((({request:e})=>"navigate"===e.mode),new NetworkFirst({cacheName:"pages"})),registerRoute((({request:e})=>["style","script"].includes(e.destination)),new CacheFirst({cacheName:"static-resources"})),registerRoute((({request:e})=>"image"===e.destination),new CacheFirst({cacheName:"images"})),registerRoute((({url:e})=>e.pathname.startsWith("/api/")),new NetworkFirst({cacheName:"api-cache"})),setCatchHandler((async({event:e})=>"document"===e.request.destination?caches.match("/offline.html"):Response.error())),self.addEventListener("push",(e=>{let t={title:"Notifikasi",body:"Ada pesan masuk!",url:"/"};if(e.data)try{t=e.data.json()}catch(i){t.body=e.data.text()}const i={body:t.body||"Pesan baru diterima.",icon:"/images/icon-192x192.png",badge:"/images/icon-512x512.png",data:{url:t.url||"/"}};e.waitUntil(self.registration.showNotification(t.title||"Notifikasi",i))})),self.addEventListener("notificationclick",(e=>{e.notification.close();const t=e.notification.data?.url||"/";e.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then((e=>{for(const i of e)if(i.url===t&&"focus"in i)return i.focus();if(clients.openWindow)return clients.openWindow(t)})))}));